import{_ as e,r as o,o as c,c as p,d as n,a as r,F as l,b as a,e as t}from"./app.0702af34.js";const i={},u=a('<h1 id="react-memo" tabindex="-1"><a class="header-anchor" href="#react-memo">\xB6</a> <span class="prefix"></span><span class="content" id="react-memo"><a class="header-anchor" href="#react-memo" aria-hidden="true">#</a> React.memo</span><span class="suffix"></span></h1>',1),d=n("details",null,[n("summary",null,"\u539F\u4F5C\u89C6\u9891"),n("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/DEPwA3mv_R8",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""})],-1),m=a('<h2 id="\u662F\u5426\u5EFA\u7ACBmemoization\u7684\u5BF9\u6BD4" tabindex="-1"><a class="header-anchor" href="#\u662F\u5426\u5EFA\u7ACBmemoization\u7684\u5BF9\u6BD4">\xB6</a> <span class="prefix"></span><span class="content" id="\u662F\u5426\u5EFA\u7ACBmemoization\u7684\u5BF9\u6BD4"><a class="header-anchor" href="#\u662F\u5426\u5EFA\u7ACBmemoization\u7684\u5BF9\u6BD4" aria-hidden="true">#</a> \u662F\u5426\u5EFA\u7ACBmemoization\u7684\u5BF9\u6BD4</span><span class="suffix"></span></h2><h3 id="what-is-react-memo" tabindex="-1"><a class="header-anchor" href="#what-is-react-memo">\xB6</a> <span class="prefix"></span><span class="content" id="what-is-react-memo"><a class="header-anchor" href="#what-is-react-memo" aria-hidden="true">#</a> <strong>what is React.memo</strong></span><span class="suffix"></span></h3><p>eng:https://devdocs.io/react/react-api#reactmemo</p><p>zh-cn:https://zh-hans.reactjs.org/docs/react-api.html#reactmemo</p><ol><li><p>create a <code>index.js</code> file, then append a child called <code>Swatch</code></p></li><li><p>index.js is a React component,</p></li></ol><ul><li>it has states\uFF1A <code>count</code>, <code>color</code></li><li>two buttons can control its states and <strong>Re-Render App</strong></li><li><code>Swatch</code> receive props includes <code>color</code></li></ul><ol start="3"><li><code>Swatch</code> without memo:</li></ol><section class="table-container"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><strong>SWATCH HAS SAME PROPS:</strong></td><td>click <strong>color button</strong> 5 times</td><td>ReRender App &amp;&amp; Re-Render Swatch</td></tr><tr><td><strong>SWATCH HAS Different PROPS:</strong></td><td>click <strong>color button</strong> 5 times</td><td>ReRender App &amp;&amp; Re-Render Swatch</td></tr></tbody></table></section><ol start="4"><li><code>Swatch</code> wrapped in memo:</li></ol>',9),k=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[t(),n("span",{class:"token keyword"},"const"),t(),n("span",{class:"token constant"},"T"),t(),n("span",{class:"token operator"},"="),t(" React"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"memo"),n("span",{class:"token punctuation"},"("),t("Swatch"),n("span",{class:"token punctuation"},")"),t(`
 `),n("span",{class:"token keyword"},"return"),t(),n("span",{class:"token operator"},"<"),n("span",{class:"token constant"},"T"),t(" color"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),t("color"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token constant"},"T"),n("span",{class:"token operator"},">"),t(`
`)]),n("div",{class:"m-mdic-copy-wrapper"},[n("div",{class:"u-mdic-copy-notify",id:"j-notify-1651016433284-53404"},"\u590D\u5236\u6210\u529F"),n("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":` const T = React.memo(Swatch)
 return <T color={color}></T>
`,"data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1651016433284-53404","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"\u590D\u5236\u5931\u8D25",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"\u590D\u5236")])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br")])],-1),b=a('<section class="table-container"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><strong>SWATCH HAS SAME PROPS:</strong></td><td>click <strong>count button</strong> 5 times</td><td>ReRender App <strong>Only</strong></td></tr><tr><td><strong>SWATCH HAS Different PROPS:</strong></td><td>click <strong>color button</strong> 5 times</td><td>ReRender App &amp;&amp; Re-Render Swatch</td></tr></tbody></table></section><h3 id="code" tabindex="-1"><a class="header-anchor" href="#code">\xB6</a> <span class="prefix"></span><span class="content" id="code"><a class="header-anchor" href="#code" aria-hidden="true">#</a> <strong>code</strong></span><span class="suffix"></span></h3>',2),h=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"import"),t(" React"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token punctuation"},"{"),t(" useEffect"),n("span",{class:"token punctuation"},","),t(" useState"),n("span",{class:"token punctuation"},","),t(" memo "),n("span",{class:"token punctuation"},"}"),t(),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'react'"),t(`
`),n("span",{class:"token keyword"},"import"),t(" Swatch "),n("span",{class:"token keyword"},"from"),t(),n("span",{class:"token string"},"'./Swatch'"),t(`
`),n("span",{class:"token keyword"},"const"),t(),n("span",{class:"token constant"},"T"),t(),n("span",{class:"token operator"},"="),t(),n("span",{class:"token function"},"memo"),n("span",{class:"token punctuation"},"("),t("Swatch"),n("span",{class:"token punctuation"},")"),t(`
`),n("span",{class:"token keyword"},"export"),t(),n("span",{class:"token keyword"},"default"),t(),n("span",{class:"token keyword"},"function"),t(),n("span",{class:"token function"},"ComponentWithMemo"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token punctuation"},"{"),t(`
    `),n("span",{class:"token keyword"},"const"),t(),n("span",{class:"token punctuation"},"["),t("count"),n("span",{class:"token punctuation"},","),t(" setCount"),n("span",{class:"token punctuation"},"]"),t(),n("span",{class:"token operator"},"="),t(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token keyword"},"const"),t(),n("span",{class:"token punctuation"},"["),t("color"),n("span",{class:"token punctuation"},","),t(" setColor"),n("span",{class:"token punctuation"},"]"),t(),n("span",{class:"token operator"},"="),t(),n("span",{class:"token function"},"useState"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'red'"),n("span",{class:"token punctuation"},")"),t(`

    console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token template-string"},[n("span",{class:"token template-punctuation string"},"`"),n("span",{class:"token string"},"App rendered: "),n("span",{class:"token interpolation"},[n("span",{class:"token interpolation-punctuation punctuation"},"${"),t("count"),n("span",{class:"token interpolation-punctuation punctuation"},"}")]),n("span",{class:"token template-punctuation string"},"`")]),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token keyword"},"const"),t(),n("span",{class:"token function-variable function"},"countAppRendered"),t(),n("span",{class:"token operator"},"="),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token function"},"setCount"),n("span",{class:"token punctuation"},"("),t("count "),n("span",{class:"token operator"},"+"),t(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),t(`

    `),n("span",{class:"token function"},"useEffect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
        `),n("span",{class:"token keyword"},"return"),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
            `),n("span",{class:"token function"},"setCount"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),t(`
            `),n("span",{class:"token function"},"setColor"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'red'"),n("span",{class:"token punctuation"},")"),t(`
        `),n("span",{class:"token punctuation"},"}"),t(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),t(`
    `),n("span",{class:"token keyword"},"return"),t(),n("span",{class:"token punctuation"},"("),t(`
        `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},">"),t(`
            `),n("span",{class:"token operator"},"<"),t("h1"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},"{"),t("count"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),t("h1"),n("span",{class:"token operator"},">"),t(`
            `),n("span",{class:"token operator"},"<"),t("div"),n("span",{class:"token operator"},">"),t(`
                `),n("span",{class:"token operator"},"<"),t("button style"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"{"),t(),n("span",{class:"token literal-property property"},"margin"),n("span",{class:"token operator"},":"),t(),n("span",{class:"token number"},"5"),t(),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),t(" onClick"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),t("countAppRendered"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),t("Re"),n("span",{class:"token operator"},"-"),t("Render App"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),t("button"),n("span",{class:"token operator"},">"),t(`
                `),n("span",{class:"token operator"},"<"),t("button onClick"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
                    `),n("span",{class:"token function"},"countAppRendered"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),t(`
                    `),n("span",{class:"token function"},"setColor"),n("span",{class:"token punctuation"},"("),t("color "),n("span",{class:"token operator"},"==="),t(),n("span",{class:"token string"},"'red'"),t(),n("span",{class:"token operator"},"?"),t(),n("span",{class:"token string"},"'blue'"),t(),n("span",{class:"token operator"},":"),t(),n("span",{class:"token string"},"'red'"),n("span",{class:"token punctuation"},")"),t(`
                `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),t("Change Color"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),t("button"),n("span",{class:"token operator"},">"),t(`
            `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),t("div"),n("span",{class:"token operator"},">"),t(`
            `),n("span",{class:"token operator"},"<"),n("span",{class:"token constant"},"T"),t(" color"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),t("color"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token operator"},">"),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token constant"},"T"),n("span",{class:"token operator"},">"),t(`
            `),n("span",{class:"token punctuation"},"{"),n("span",{class:"token comment"},"/* <Swatch color={color}></Swatch> */"),n("span",{class:"token punctuation"},"}"),t(`
        `),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"/"),n("span",{class:"token operator"},">"),t(`
    `),n("span",{class:"token punctuation"},")"),t(`
`)]),n("div",{class:"m-mdic-copy-wrapper"},[n("div",{class:"u-mdic-copy-notify",id:"j-notify-1651016433285-34455"},"\u590D\u5236\u6210\u529F"),n("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":`import React, { useEffect, useState, memo } from 'react'
import Swatch from './Swatch'
const T = memo(Swatch)
export default function ComponentWithMemo() {
    const [count, setCount] = useState(0)
    const [color, setColor] = useState('red')

    console.log(\`App rendered: \${count}\`)
    const countAppRendered = () => setCount(count + 1)

    useEffect(() => {
        return () => {
            setCount(0)
            setColor('red')
        }
    }, [])
    return (
        <>
            <h1>{count}</h1>
            <div>
                <button style={{ margin: 5 }} onClick={countAppRendered}>Re-Render App</button>
                <button onClick={() => {
                    countAppRendered()
                    setColor(color === 'red' ? 'blue' : 'red')
                }}>Change Color</button>
            </div>
            <T color={color}></T>
            {/* <Swatch color={color}></Swatch> */}
        </>
    )
`,"data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1651016433285-34455","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"\u590D\u5236\u5931\u8D25",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"\u590D\u5236")])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br"),n("span",{class:"line-number"},"9"),n("br"),n("span",{class:"line-number"},"10"),n("br"),n("span",{class:"line-number"},"11"),n("br"),n("span",{class:"line-number"},"12"),n("br"),n("span",{class:"line-number"},"13"),n("br"),n("span",{class:"line-number"},"14"),n("br"),n("span",{class:"line-number"},"15"),n("br"),n("span",{class:"line-number"},"16"),n("br"),n("span",{class:"line-number"},"17"),n("br"),n("span",{class:"line-number"},"18"),n("br"),n("span",{class:"line-number"},"19"),n("br"),n("span",{class:"line-number"},"20"),n("br"),n("span",{class:"line-number"},"21"),n("br"),n("span",{class:"line-number"},"22"),n("br"),n("span",{class:"line-number"},"23"),n("br"),n("span",{class:"line-number"},"24"),n("br"),n("span",{class:"line-number"},"25"),n("br"),n("span",{class:"line-number"},"26"),n("br"),n("span",{class:"line-number"},"27"),n("br"),n("span",{class:"line-number"},"28"),n("br"),n("span",{class:"line-number"},"29"),n("br"),n("span",{class:"line-number"},"30"),n("br")])],-1),f=a('<h2 id="\u7834\u574Freact-memo" tabindex="-1"><a class="header-anchor" href="#\u7834\u574Freact-memo">\xB6</a> <span class="prefix"></span><span class="content" id="\u7834\u574Freact-memo"><a class="header-anchor" href="#\u7834\u574Freact-memo" aria-hidden="true">#</a> \u7834\u574FReact.memo</span><span class="suffix"></span></h2><p>\u5F53props\u4E2D\u4F20\u5165\u5BF9\u8C61\u548C\u65B9\u6CD5\u7684\u65F6\u5019\uFF0Cmemoization\u4F1A\u88AB\u7834\u574F\u3002</p><ol><li>\u5982\u679Cprops\u4E2D\u53EA\u6709\u5BF9\u8C61\uFF1A</li></ol><blockquote class="multiquote-1"><p>everytime we go through here and we create a new object with a new reference.</p><p>it may have exactly the same value,</p><p>but react is doing a shallow comparison on the props.</p></blockquote><figure><img src="https://img.ukx.cn/abcdocker/2022/04/04/c205204e5e3b8/c205204e5e3b8.png" alt=""><figcaption>image-20220404225836511</figcaption></figure><p>\u6B64\u65F6\u6709\u4E24\u79CD<strong>\u89E3\u51B3\u65B9\u6CD5</strong></p><ul><li>\u4E3A<code>React.memo</code>\u63D0\u4F9B\u7B2C\u4E8C\u4E2A\u53C2\u6570</li></ul>',7),y=n("div",{class:"language-javascript ext-js line-numbers-mode"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),t(),n("span",{class:"token constant"},"T"),t(),n("span",{class:"token operator"},"="),t(),n("span",{class:"token function"},"memo"),n("span",{class:"token punctuation"},"("),t("Swatch"),n("span",{class:"token punctuation"},","),t(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[t("prevProps"),n("span",{class:"token punctuation"},","),t(" nextProps")]),n("span",{class:"token punctuation"},")"),t(),n("span",{class:"token operator"},"=>"),t(),n("span",{class:"token punctuation"},"{"),t(`
	`),n("span",{class:"token keyword"},"return"),t(" prevProps"),n("span",{class:"token punctuation"},"."),t("params"),n("span",{class:"token punctuation"},"."),t("color "),n("span",{class:"token operator"},"==="),t(" nextProps"),n("span",{class:"token punctuation"},"."),t("params"),n("span",{class:"token punctuation"},"."),t(`color
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),t(`
`)]),n("div",{class:"m-mdic-copy-wrapper"},[n("div",{class:"u-mdic-copy-notify",id:"j-notify-1651016433287-5494"},"\u590D\u5236\u6210\u529F"),n("button",{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":`const T = memo(Swatch, (prevProps, nextProps) => {
	return prevProps.params.color === nextProps.params.color
})
`,"data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1651016433287-5494","data-mdic-notify-delay":"1000","data-mdic-copy-fail-text":"\u590D\u5236\u5931\u8D25",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"},"\u590D\u5236")])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br")])],-1),g=a('<ul><li>\u5C06\u8FD9\u4E2A\u5BF9\u8C61\u7528useMemo\u58F0\u660E</li></ul><figure><img src="https://img.ukx.cn/abcdocker/2022/04/04/1057b7b12d115/1057b7b12d115.png" alt=""><figcaption>image-20220404232816452</figcaption></figure><ol start="2"><li>\u5982\u679Cprops\u4E2D\u4F60\u8FD8\u5B9A\u4E86\u4E2A\u65B9\u6CD5\uFF0C\u4E5F\u4F1A\u7834\u574Fmemoization</li></ol><figure><img src="https://img.ukx.cn/abcdocker/2022/04/04/9715173da01e4/9715173da01e4.png" alt=""><figcaption>image-20220404233134236</figcaption></figure><h3 id="diff-code" tabindex="-1"><a class="header-anchor" href="#diff-code">\xB6</a> <span class="prefix"></span><span class="content" id="diff-code"><a class="header-anchor" href="#diff-code" aria-hidden="true">#</a> diff code</span><span class="suffix"></span></h3>',5),w={href:"https://github.com/buuoltwo/crash.sandbox/commit/1f825357e9247600b4b2a39766b1645cc19ee862#diff-565dec190be24012c5f003bb309ec7cafe3eba2ee39c6b280bbcda064cc5b770",target:"_blank",rel:"noopener noreferrer"},C=t("links:");function x(v,S){const s=o("ExternalLinkIcon");return c(),p(l,null,[u,d,m,k,b,h,f,y,g,n("p",null,[n("a",w,[C,r(s)])])],64)}var _=e(i,[["render",x]]);export{_ as default};
